(()=>{"use strict";const e=e=>{let t=null,r=[];const o=(e,o)=>{o.isValidAttack(e)&&o.receiveAttack(e),r.push(e),t=!1},l=()=>[Math.floor(10*Math.random()),Math.floor(10*Math.random())],c=e=>{const o=l();for(;!e.isValidAttack(o);)o=l;e.receiveAttack(o),r.push(o),t=!1};return{humanPlayerAttack:o,computerPlayerAttack:c,attack:"human"===e?o:c,isMyTurn:t,myAttacks:r}},t=()=>{const e=[],t=[],r=[],o=[],l=(r,o)=>{const l=(e=>{let t=0,r=!1,o=e;return{hit:()=>(t+=1,t),isSunk:()=>(t===o&&(r=!0),r),hits:t,sunk:r,shipLength:o}})(o),[c,a]=r;for(let t=0;t<o;t++)if(null!==e[c+t][a])throw new Error("Cannot place ship on an occupied spot");for(let t=0;t<o;t++)e[c+t][a]=l;t.push(l)};return(()=>{for(let t=0;t<10;t++){e[t]=[];for(let r=0;r<10;r++)e[t][r]=null}})(),{placeShip:l,grid:e,ships:t,receiveAttack:t=>{const[l,c]=t;null===e[l][c]?(r.push([l,c]),e[l][c]=0):(e[l][c].hit(),o.push([l,c]))},placeRandomShips:()=>{const e=[5,4,3,3,2];for(let t=0;t<e.length;t++){let r=!1;for(;!r;){let o=Math.floor(10*Math.random()),c=Math.floor(10*Math.random());try{l([o,c],e[t]),r=!0}catch(e){}}}return t},missedAttacks:r,successfulAttacks:o,allShipsSunk:()=>t.every((e=>e.isSunk())),isValidAttack:e=>{const[t,l]=e;for(const[e,r]of o)if(e===t&&r===l)return!1;for(const[e,o]of r)if(e===t&&o===l)return!1;return!0},getShips:()=>t,getGrid:()=>e}},r=(e("human"),e("computer"),t());t().placeRandomShips();const o=(e=>{const t=[5,4,3,3,2];let r=0;const o=l=>{const c=l.target.getAttribute("data-coordinate"),[a,n]=JSON.parse(c);e.placeShip([a,n],t[r]);for(let e=0;e<t[r];e++)document.querySelector(`.cell[data-coordinate="[${a+e}, ${n}]"]`).className="ship-cell";r++,r>=t.length&&document.querySelector(".pre-board").removeEventListener("click",o)},l=()=>{const e=document.querySelectorAll(".pre-board .ship-cell"),t=document.querySelectorAll(".human .cell"),r=[];for(let t=0;t<e.length;t++)r.push(e[t].getAttribute("data-coordinate"));for(let e=0;e<t.length;e++){let o=t[e],l=t[e].getAttribute("data-coordinate");r.includes(l)&&(o.className="ship-cell")}};return{createCells:e=>{const t=document.querySelector(e);t.style.gridTemplateColumns="repeat(10, 1fr)",t.style.gridTemplateRows="repeat(10, 1fr)";for(let e=0;e<100;e++){let r=document.createElement("div");r.className="cell";const o=e%10,l=Math.floor(e/10);r.setAttribute("data-coordinate",`[${o}, ${l}]`),t.insertAdjacentElement("beforeend",r)}},insertShip:()=>{document.querySelector(".pre-board").addEventListener("click",o)},closeModal:()=>{const e=document.querySelector(".begin"),t=document.querySelector(".welcomeScreen");e.addEventListener("click",(()=>{t.close(),l()}))},showShips:l}})(r);o.createCells(".pre-board"),o.createCells(".human"),o.createCells(".computer"),o.insertShip(),o.closeModal()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ekIsR0FFSixNQUFPLENBQUNVLFlBcEVhQyxJQUNqQixNQUNNOUQsRUFBUWlELFNBQVNDLGNBQWNZLEdBQ3JDOUQsRUFBTStELE1BQU1DLG9CQUFzQixrQkFDbENoRSxFQUFNK0QsTUFBTUUsaUJBQW1CLGtCQUcvQixJQUFLLElBQUl6QyxFQUFJLEVBQUdBLEVBREYwQyxJQUNlMUMsSUFBSSxDQUM3QixJQUFJMkMsRUFBT2xCLFNBQVNtQixjQUFjLE9BQ2xDRCxFQUFLaEIsVUFBWSxPQUNqQixNQUFNN0IsRUFBSUUsRUFUSyxHQVVURCxFQUFJbEIsS0FBS0MsTUFBTWtCLEVBVk4sSUFXZjJDLEVBQUtFLGFBQWEsa0JBQW1CLElBQUkvQyxNQUFNQyxNQUMvQ3ZCLEVBQU1zRSxzQkFBc0IsWUFBYUgsRUFDN0MsR0FzRGlCSSxXQWhDRixLQUNFdEIsU0FBU0MsY0FBYyxjQUMvQnNCLGlCQUFpQixRQUFTLEVBQXFCLEVBOEIzQkMsV0EzQmQsS0FDZixNQUFNQyxFQUFRekIsU0FBU0MsY0FBYyxVQUMvQnlCLEVBQWdCMUIsU0FBU0MsY0FBYyxrQkFDN0N3QixFQUFNRixpQkFBaUIsU0FBUyxLQUM1QkcsRUFBY0MsUUFDZHZCLEdBQVUsR0FDYixFQXFCd0NBLFlBQ2hELEVJN0RpQixDQUFPZixHQUV6QkcsRUFBVW9CLFlBQVksY0FDdEJwQixFQUFVb0IsWUFBWSxVQUN0QnBCLEVBQVVvQixZQUFZLGFBRXRCcEIsRUFBVThCLGFBQ1Y5QixFQUFVZ0MsWSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9zaGlwcy5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV2ZW50cyA9ICgoYm9hcmQpID0+IHtcbiAgICBjb25zdCBzaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXTtcbiAgICBsZXQgdGhpc1NoaXAgPSAwXG5cbiAgICBjb25zdCBjcmVhdGVDZWxscyA9IChjb250YWluZXIpID0+IHtcbiAgICAgICAgY29uc3QgZGltZW5zaW9ucyA9IDEwXG4gICAgICAgIGNvbnN0IGJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpXG4gICAgICAgIGJvYXJkLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSBgcmVwZWF0KCR7ZGltZW5zaW9uc30sIDFmcilgO1xuICAgICAgICBib2FyZC5zdHlsZS5ncmlkVGVtcGxhdGVSb3dzID0gYHJlcGVhdCgke2RpbWVuc2lvbnN9LCAxZnIpYDtcbiAgICBcbiAgICAgICAgbGV0IG51bURpdnMgPSBkaW1lbnNpb25zICogZGltZW5zaW9ucztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1EaXZzOyBpKyspe1xuICAgICAgICAgICAgbGV0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgXG4gICAgICAgICAgICBjZWxsLmNsYXNzTmFtZSA9ICdjZWxsJ1xuICAgICAgICAgICAgY29uc3QgeCA9IGkgJSBkaW1lbnNpb25zOyAvLyBDYWxjdWxhdGUgeCBjb29yZGluYXRlXG4gICAgICAgICAgICBjb25zdCB5ID0gTWF0aC5mbG9vcihpIC8gZGltZW5zaW9ucyk7IC8vIENhbGN1bGF0ZSB5IGNvb3JkaW5hdGVcbiAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdkYXRhLWNvb3JkaW5hdGUnLCBgWyR7eH0sICR7eX1dYClcbiAgICAgICAgICAgIGJvYXJkLmluc2VydEFkamFjZW50RWxlbWVudChcImJlZm9yZWVuZFwiLCBjZWxsKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmV0cmlldmVDb29yZGluYXRlcyA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCBjbGlja2VkQ2VsbCA9IGV2ZW50LnRhcmdldFxuICAgICAgICBjb25zdCBjb29yZGluYXRlcyA9IGNsaWNrZWRDZWxsLmdldEF0dHJpYnV0ZSgnZGF0YS1jb29yZGluYXRlJylcbiAgICAgICAgY29uc3QgW3gsIHldID0gSlNPTi5wYXJzZShjb29yZGluYXRlcylcbiAgICAgICAgXG4gICAgICAgIGJvYXJkLnBsYWNlU2hpcChbeCwgeV0sc2hpcExlbmd0aHNbdGhpc1NoaXBdKVxuICAgICAgICBcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3Roc1t0aGlzU2hpcF07IGkrKyl7XG4gICAgICAgICAgICBsZXQgc2hpcENlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuY2VsbFtkYXRhLWNvb3JkaW5hdGU9XCJbJHt4K2l9LCAke3l9XVwiXWApXG4gICAgICAgICAgICBzaGlwQ2VsbC5jbGFzc05hbWUgPSAnc2hpcC1jZWxsJ1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpc1NoaXArK1xuICAgICAgICBpZiAodGhpc1NoaXAgPj0gc2hpcExlbmd0aHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBwcmVCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmUtYm9hcmQnKTtcbiAgICAgICAgICAgIHByZUJvYXJkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmV0cmlldmVDb29yZGluYXRlcyk7XG4gICAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGluc2VydFNoaXAgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByZUJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZS1ib2FyZCcpXG4gICAgICAgIHByZUJvYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKHJldHJpZXZlQ29vcmRpbmF0ZXMpKVxuICAgIH1cblxuICAgIGNvbnN0IGNsb3NlTW9kYWwgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGJlZ2luID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJlZ2luJylcbiAgICAgICAgY29uc3Qgd2VsY29tZVNjcmVlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53ZWxjb21lU2NyZWVuJylcbiAgICAgICAgYmVnaW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB3ZWxjb21lU2NyZWVuLmNsb3NlKClcbiAgICAgICAgICAgIHNob3dTaGlwcygpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgY29uc3Qgc2hvd1NoaXBzID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBwcmVCb2FyZE5vZGVMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmUtYm9hcmQgLnNoaXAtY2VsbFwiKVxuICAgICAgICBjb25zdCBodW1hbkJvYXJkTm9kZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmh1bWFuIC5jZWxsXCIpXG4gICAgICAgIGNvbnN0IHNoaXBDZWxscyA9IFtdXG5cbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHByZUJvYXJkTm9kZUxpc3QubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgc2hpcENlbGxzLnB1c2gocHJlQm9hcmROb2RlTGlzdFtpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29vcmRpbmF0ZScpKVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGh1bWFuQm9hcmROb2RlTGlzdC5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBsZXQgbm9kZSA9IGh1bWFuQm9hcmROb2RlTGlzdFtpXVxuICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGUgPSBodW1hbkJvYXJkTm9kZUxpc3RbaV0uZ2V0QXR0cmlidXRlKCdkYXRhLWNvb3JkaW5hdGUnKVxuICAgICAgICAgICAgaWYoc2hpcENlbGxzLmluY2x1ZGVzKGNvb3JkaW5hdGUpKXtcbiAgICAgICAgICAgICAgICBub2RlLmNsYXNzTmFtZSA9ICdzaGlwLWNlbGwnXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge2NyZWF0ZUNlbGxzLCBpbnNlcnRTaGlwLCBjbG9zZU1vZGFsLCBzaG93U2hpcHN9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgZXZlbnRzIiwiY29uc3QgcGxheWVyRmFjdG9yeSA9IChwbGF5ZXJUeXBlKSA9PiB7XG4gICAgbGV0IGlzTXlUdXJuID0gbnVsbFxuICAgIGxldCBteUF0dGFja3MgPSBbXVxuXG4gICAgY29uc3QgaHVtYW5QbGF5ZXJBdHRhY2sgPSAoY29vcmRpbmF0ZXMsIGJvYXJkKSA9PiB7XG4gICAgICAgIGlmIChib2FyZC5pc1ZhbGlkQXR0YWNrKGNvb3JkaW5hdGVzKSl7XG4gICAgICAgICAgICBib2FyZC5yZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGVzKVxuICAgICAgICB9XG4gICAgICAgIG15QXR0YWNrcy5wdXNoKGNvb3JkaW5hdGVzKVxuICAgICAgICBpc015VHVybiA9IGZhbHNlXG4gICAgfVxuXG4gICAgY29uc3QgZ2V0UmFuZG9tQ29vcmRpbmF0ZXMgPSAoKSA9PiB7XG4gICAgICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApXG4gICAgICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApXG4gICAgICAgIHJldHVybiBbeCwgeV1cbiAgICB9XG5cbiAgICBjb25zdCBjb21wdXRlclBsYXllckF0dGFjayA9IChib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBjb29yZGluYXRlcyA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKClcbiAgICAgICAgd2hpbGUoIWJvYXJkLmlzVmFsaWRBdHRhY2soY29vcmRpbmF0ZXMpKXtcbiAgICAgICAgICAgIGNvb3JkaW5hdGVzID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXNcbiAgICAgICAgfVxuICAgICAgICBib2FyZC5yZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGVzKVxuICAgICAgICBteUF0dGFja3MucHVzaChjb29yZGluYXRlcylcbiAgICAgICAgaXNNeVR1cm4gPSBmYWxzZVxuICAgIH1cblxuICAgIGNvbnN0IGF0dGFjayA9IHBsYXllclR5cGUgPT09IFwiaHVtYW5cIiA/IGh1bWFuUGxheWVyQXR0YWNrIDogY29tcHV0ZXJQbGF5ZXJBdHRhY2s7XG5cbiAgICByZXR1cm57aHVtYW5QbGF5ZXJBdHRhY2ssIGNvbXB1dGVyUGxheWVyQXR0YWNrLCBhdHRhY2ssIGlzTXlUdXJuLFxuICAgICAgICAgICBteUF0dGFja3N9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBsYXllckZhY3Rvcnlcbi8vbW9kdWxlLmV4cG9ydHMgPSBwbGF5ZXJGYWN0b3J5IiwiaW1wb3J0IHNoaXBGYWN0b3J5IGZyb20gJy4vc2hpcHMnXG5cbmNvbnN0IGdhbWVib2FyZEZhY3RvcnkgPSAoKSA9PiB7XG4gICAgY29uc3QgZ3JpZCA9IFtdXG4gICAgY29uc3Qgc2hpcHMgPSBbXVxuICAgIGNvbnN0IG1pc3NlZEF0dGFja3MgPSBbXVxuICAgIGNvbnN0IHN1Y2Nlc3NmdWxBdHRhY2tzID0gW11cblxuICAgIGNvbnN0IHBvcHVsYXRlR3JpZCA9ICgpID0+IHtcbiAgICAgICAgbGV0IHJvd3MgPSAxMFxuICAgICAgICBsZXQgY29scyA9IDEwXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCByb3dzOyBpKyspe1xuICAgICAgICAgICAgZ3JpZFtpXSA9IFtdO1xuICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IGNvbHM7IGorKyl7XG4gICAgICAgICAgICAgICAgZ3JpZFtpXVtqXSA9IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHBsYWNlU2hpcCA9IChjb29yZGluYXRlcywgc2hpcExlbmd0aCkgPT4ge1xuICAgICAgICBjb25zdCBzaGlwID0gc2hpcEZhY3Rvcnkoc2hpcExlbmd0aClcbiAgICAgICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZXM7XG4gICAgICAgIFxuICAgICAgICBmb3IobGV0IGkgPTA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgaWYoZ3JpZFt4ICsgaV1beV0gIT09IG51bGwpe1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHBsYWNlIHNoaXAgb24gYW4gb2NjdXBpZWQgc3BvdCcpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGdyaWRbeCArIGldW3ldID0gc2hpcDtcbiAgICAgICAgfVxuXG4gICAgICAgIHNoaXBzLnB1c2goc2hpcClcbiAgICB9XG5cbiAgICBjb25zdCBwbGFjZVJhbmRvbVNoaXBzID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXTtcbiAgICAgICAgXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3Rocy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBsZXQgcGxhY2VkID0gZmFsc2VcbiAgICAgICAgICAgIHdoaWxlKCFwbGFjZWQpe1xuICAgICAgICAgICAgICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApXG4gICAgICAgICAgICAgICAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMClcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBwbGFjZVNoaXAoW3gseV0sIHNoaXBMZW5ndGhzW2ldKVxuICAgICAgICAgICAgICAgICAgICBwbGFjZWQgPSB0cnVlXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3Ipe1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaGlwc1xuICAgICAgfTtcblxuICAgIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICAgICAgY29uc3QgW3gseV0gPSBjb29yZGluYXRlc1xuICAgICAgICBpZihncmlkW3hdW3ldID09PSBudWxsKXtcbiAgICAgICAgICAgIG1pc3NlZEF0dGFja3MucHVzaChbeCx5XSlcbiAgICAgICAgICAgIGdyaWRbeF1beV0gPSAwIC8vMCB3aWxsIGluZGljYXRlIGEgZ3JpZCBwb3NpdGlvbiB0aGF0IHdhcyBhdHRhY2tlZCBhbmQgbWlzc2VkXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgc2hpcCA9IGdyaWRbeF1beV1cbiAgICAgICAgICAgIHNoaXAuaGl0KClcbiAgICAgICAgICAgIHN1Y2Nlc3NmdWxBdHRhY2tzLnB1c2goW3gseV0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBnZXRTaGlwcyA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHNoaXBzXG4gICAgfVxuXG4gICAgY29uc3QgZ2V0R3JpZCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIGdyaWRcbiAgICB9XG5cbiAgICBjb25zdCBhbGxTaGlwc1N1bmsgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBzaGlwcy5ldmVyeSgoc2hpcCkgPT4gc2hpcC5pc1N1bmsoKSlcbiAgICB9XG5cbiAgICBjb25zdCBpc1ZhbGlkQXR0YWNrID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuICAgICAgICBmb3IgKGNvbnN0IFthdHRhY2tYLCBhdHRhY2tZXSBvZiBzdWNjZXNzZnVsQXR0YWNrcykge1xuICAgICAgICAgICAgaWYgKGF0dGFja1ggPT09IHggJiYgYXR0YWNrWSA9PT0geSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IFthdHRhY2tYLCBhdHRhY2tZXSBvZiBtaXNzZWRBdHRhY2tzKSB7XG4gICAgICAgICAgICBpZiAoYXR0YWNrWCA9PT0geCAmJiBhdHRhY2tZID09PSB5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcG9wdWxhdGVHcmlkKClcblxuICAgIHJldHVybntwbGFjZVNoaXAsIGdyaWQsIHNoaXBzLCByZWNlaXZlQXR0YWNrLCBwbGFjZVJhbmRvbVNoaXBzLCBcbiAgICAgICAgbWlzc2VkQXR0YWNrcywgc3VjY2Vzc2Z1bEF0dGFja3MsIGFsbFNoaXBzU3VuaywgaXNWYWxpZEF0dGFjaywgXG4gICAgICAgIGdldFNoaXBzLCBnZXRHcmlkfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IGdhbWVib2FyZEZhY3Rvcnlcbi8vbW9kdWxlLmV4cG9ydHMgPSBnYW1lYm9hcmRGYWN0b3J5IiwiY29uc3Qgc2hpcEZhY3RvcnkgPSAobGVuZ3RoKSA9PiB7XG4gICAgbGV0IGhpdHMgPSAwIFxuICAgIGxldCBzdW5rID0gZmFsc2VcbiAgICBsZXQgc2hpcExlbmd0aCA9IGxlbmd0aFxuXG4gICAgY29uc3QgaGl0ID0gKCkgPT4ge1xuICAgICAgICBoaXRzICs9IDFcbiAgICAgICAgcmV0dXJuIGhpdHNcbiAgICB9XG5cbiAgICBjb25zdCBpc1N1bmsgPSAoKSA9PiB7XG4gICAgICAgIGlmKGhpdHMgPT09IHNoaXBMZW5ndGgpe1xuICAgICAgICAgICAgc3VuayA9IHRydWVcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3Vua1xuICAgIH1cblxuICAgIHJldHVybiB7aGl0LCBpc1N1bmssIGhpdHMsIHN1bmssIHNoaXBMZW5ndGh9XG59XG5leHBvcnQgZGVmYXVsdCBzaGlwRmFjdG9yeVxuLy9tb2R1bGUuZXhwb3J0cyA9IHNoaXBGYWN0b3J5IiwiaW1wb3J0IGV2ZW50cyBmcm9tIFwiLi9tb2R1bGVzL2RvbVwiO1xuaW1wb3J0IHBsYXllckZhY3RvcnkgZnJvbSBcIi4vbW9kdWxlcy9wbGF5ZXJcIlxuaW1wb3J0IGdhbWVib2FyZEZhY3RvcnkgZnJvbSBcIi4vbW9kdWxlcy9nYW1lYm9hcmRcIlxuXG5jb25zdCBodW1hblBsYXllciA9IHBsYXllckZhY3RvcnkoJ2h1bWFuJykgLy9jcmVhdGUgcGxheWVyIGluc3RhbmNlc1xuY29uc3QgYWlQbGF5ZXIgPSBwbGF5ZXJGYWN0b3J5KCdjb21wdXRlcicpXG5cbmNvbnN0IGh1bWFuR2FtZWJvYXJkID0gZ2FtZWJvYXJkRmFjdG9yeSgpIC8vY3JlYXRlIGJvYXJkIGluc3RhbmNlcyBcbmNvbnN0IGFpR2FtZWJvYXJkID0gZ2FtZWJvYXJkRmFjdG9yeSgpXG5cbmFpR2FtZWJvYXJkLnBsYWNlUmFuZG9tU2hpcHMoKSAvL3BvcHVsYXRlIGFpIGJvYXJkIHdpdGggc2hpcHNcblxuY29uc3QgZG9tRXZlbnRzID0gZXZlbnRzKGh1bWFuR2FtZWJvYXJkKVxuXG5kb21FdmVudHMuY3JlYXRlQ2VsbHMoJy5wcmUtYm9hcmQnKVxuZG9tRXZlbnRzLmNyZWF0ZUNlbGxzKCcuaHVtYW4nKVxuZG9tRXZlbnRzLmNyZWF0ZUNlbGxzKCcuY29tcHV0ZXInKVxuXG5kb21FdmVudHMuaW5zZXJ0U2hpcCgpXG5kb21FdmVudHMuY2xvc2VNb2RhbCgpIl0sIm5hbWVzIjpbInBsYXllclR5cGUiLCJpc015VHVybiIsIm15QXR0YWNrcyIsImh1bWFuUGxheWVyQXR0YWNrIiwiY29vcmRpbmF0ZXMiLCJib2FyZCIsImlzVmFsaWRBdHRhY2siLCJyZWNlaXZlQXR0YWNrIiwicHVzaCIsImdldFJhbmRvbUNvb3JkaW5hdGVzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiY29tcHV0ZXJQbGF5ZXJBdHRhY2siLCJhdHRhY2siLCJncmlkIiwic2hpcHMiLCJtaXNzZWRBdHRhY2tzIiwic3VjY2Vzc2Z1bEF0dGFja3MiLCJwbGFjZVNoaXAiLCJzaGlwTGVuZ3RoIiwic2hpcCIsImxlbmd0aCIsImhpdHMiLCJzdW5rIiwiaGl0IiwiaXNTdW5rIiwieCIsInkiLCJpIiwiRXJyb3IiLCJqIiwicG9wdWxhdGVHcmlkIiwicGxhY2VSYW5kb21TaGlwcyIsInNoaXBMZW5ndGhzIiwicGxhY2VkIiwiZXJyb3IiLCJhbGxTaGlwc1N1bmsiLCJldmVyeSIsImF0dGFja1giLCJhdHRhY2tZIiwiZ2V0U2hpcHMiLCJnZXRHcmlkIiwiaHVtYW5HYW1lYm9hcmQiLCJwbGF5ZXIiLCJnYW1lYm9hcmQiLCJkb21FdmVudHMiLCJ0aGlzU2hpcCIsInJldHJpZXZlQ29vcmRpbmF0ZXMiLCJldmVudCIsInRhcmdldCIsImdldEF0dHJpYnV0ZSIsIkpTT04iLCJwYXJzZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNsYXNzTmFtZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzaG93U2hpcHMiLCJwcmVCb2FyZE5vZGVMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsImh1bWFuQm9hcmROb2RlTGlzdCIsInNoaXBDZWxscyIsIm5vZGUiLCJjb29yZGluYXRlIiwiaW5jbHVkZXMiLCJjcmVhdGVDZWxscyIsImNvbnRhaW5lciIsInN0eWxlIiwiZ3JpZFRlbXBsYXRlQ29sdW1ucyIsImdyaWRUZW1wbGF0ZVJvd3MiLCJkaW1lbnNpb25zIiwiY2VsbCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJpbnNlcnRTaGlwIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsb3NlTW9kYWwiLCJiZWdpbiIsIndlbGNvbWVTY3JlZW4iLCJjbG9zZSJdLCJzb3VyY2VSb290IjoiIn0=