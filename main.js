(()=>{"use strict";const e=e=>{let t=null,r=[];const c=(e,c)=>{c.isValidAttack(e)&&c.receiveAttack(e),r.push(e),t=!1},a=()=>[Math.floor(10*Math.random()),Math.floor(10*Math.random())],l=e=>{let c=a();for(;!e.isValidAttack(c);)c=a();return e.receiveAttack(c),r.push(c),t=!1,c};return{humanPlayerAttack:c,computerPlayerAttack:l,attack:"human"===e?c:l,isMyTurn:t,myAttacks:r}},t=()=>{const e=[],t=[],r=[],c=[],a=(r,c)=>{const a=(e=>{let t=0,r=!1,c=e;return{hit:()=>(t+=1,t),isSunk:()=>(t===c&&(r=!0),r),hits:t,sunk:r,shipLength:c}})(c),[l,o]=r;for(let t=0;t<c;t++)if(null!==e[l+t][o])throw new Error("Cannot place ship on an occupied spot");for(let t=0;t<c;t++)e[l+t][o]=a;t.push(a)};return(()=>{for(let t=0;t<10;t++){e[t]=[];for(let r=0;r<10;r++)e[t][r]=null}})(),{placeShip:a,grid:e,ships:t,receiveAttack:t=>{const[a,l]=t;null===e[a][l]?(r.push([a,l]),e[a][l]=0):(e[a][l].hit(),c.push([a,l]))},placeRandomShips:()=>{const e=[5,4,3,3,2];for(let t=0;t<e.length;t++){let r=!1;for(;!r;){let c=Math.floor(10*Math.random()),l=Math.floor(10*Math.random());try{a([c,l],e[t]),r=!0}catch(e){}}}return t},missedAttacks:r,successfulAttacks:c,allShipsSunk:()=>t.every((e=>e.isSunk())),isValidAttack:e=>{let[t,a]=e;for(let[e,r]of c)if(e===t&&r===a)return!1;for(const[e,c]of r)if(e===t&&c===a)return!1;return!0},getShips:()=>t,getGrid:()=>e}},r=e("human"),c=e("computer"),a=t(),l=t(),o=((e,t,r,c)=>{const a=[5,4,3,3,2];let l=0;const o=t=>{const r=t.target.getAttribute("data-coordinate"),[c,s]=JSON.parse(r);e.placeShip([c,s],a[l]);for(let e=0;e<a[l];e++)document.querySelector(`.cell[data-coordinate="[${c+e}, ${s}]"]`).className="ship-cell";l++,l>=a.length&&document.querySelector(".pre-board").removeEventListener("click",o)},s=()=>{const e=document.querySelectorAll(".pre-board .ship-cell"),t=document.querySelectorAll(".human .cell"),r=[];for(let t=0;t<e.length;t++)r.push(e[t].getAttribute("data-coordinate"));for(let e=0;e<t.length;e++){let c=t[e],a=t[e].getAttribute("data-coordinate");r.includes(a)&&(c.className="ship-cell")}},n=e=>{const c=e.target,a=c.getAttribute("data-coordinate"),[l,o]=JSON.parse(a);t.attack([l,o],r),0===r.getGrid()[l][o]?c.className="miss":c.className="hit",i()},i=()=>{let t=c.computerPlayerAttack(e);const[r,a]=t,l=e.getGrid();let o=document.querySelector(`.human .cell[data-coordinate="[${r}, ${a}]"]`);o||(o=document.querySelector(`.human .ship-cell[data-coordinate="[${r}, ${a}]"]`)),0===l[r][a]?o.className="miss":o.className="hit"};return{createCells:e=>{const t=document.querySelector(e);t.style.gridTemplateColumns="repeat(10, 1fr)",t.style.gridTemplateRows="repeat(10, 1fr)";for(let e=0;e<100;e++){let r=document.createElement("div");r.className="cell";const c=e%10,a=Math.floor(e/10);r.setAttribute("data-coordinate",`[${c}, ${a}]`),t.insertAdjacentElement("beforeend",r)}},insertShip:()=>{document.querySelector(".pre-board").addEventListener("click",o)},closeModal:()=>{const e=document.querySelector(".begin"),t=document.querySelector(".welcomeScreen");e.addEventListener("click",(()=>{t.close(),s()}))},showShips:s,aiAttack:i,showAttack:()=>{document.querySelector(".computer").addEventListener("click",n)}}})(a,r,l,c);o.createCells(".pre-board"),o.closeModal(),o.createCells(".human"),o.createCells(".computer"),l.placeRandomShips(),o.insertShip(),o.showAttack()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWlCLFFBQVMsRUFBcUIsRUFpRS9CQyxXQTlEVixLQUNmLE1BQU1DLEVBQVE3QixTQUFTQyxjQUFjLFVBQy9CNkIsRUFBZ0I5QixTQUFTQyxjQUFjLGtCQUM3QzRCLEVBQU1GLGlCQUFpQixTQUFTLEtBQzVCRyxFQUFjQyxRQUNkM0IsR0FBVSxHQUNiLEVBd0RvQ0EsWUFBV1UsV0FBVWtCLFdBcEIzQyxLQUNDaEMsU0FBU0MsY0FBYyxhQUMvQjBCLGlCQUFpQixRQUFTLEVBQWMsRUFtQnZELEVJbEdpQixDQUFPeEMsRUFBZ0JILEVBQWFLLEVBQWFILEdBRW5FSSxFQUFVMkIsWUFBWSxjQUN0QjNCLEVBQVVzQyxhQUNWdEMsRUFBVTJCLFlBQVksVUFDdEIzQixFQUFVMkIsWUFBWSxhQUN0QjVCLEVBQVlmLG1CQUNaZ0IsRUFBVW9DLGFBQ1ZwQyxFQUFVMEMsWSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9zaGlwcy5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV2ZW50cyA9ICgoYm9hcmQsIGh1bWFuUGxheWVyLCBlbmVteUJvYXJkLCBjb21wdXRlclBsYXllcikgPT4ge1xuICAgIGNvbnN0IHNoaXBMZW5ndGhzID0gWzUsIDQsIDMsIDMsIDJdO1xuICAgIGxldCB0aGlzU2hpcCA9IDBcblxuICAgIGNvbnN0IGNyZWF0ZUNlbGxzID0gKGNvbnRhaW5lcikgPT4ge1xuICAgICAgICBjb25zdCBkaW1lbnNpb25zID0gMTBcbiAgICAgICAgY29uc3QgYm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lcilcbiAgICAgICAgYm9hcmQuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoJHtkaW1lbnNpb25zfSwgMWZyKWA7XG4gICAgICAgIGJvYXJkLnN0eWxlLmdyaWRUZW1wbGF0ZVJvd3MgPSBgcmVwZWF0KCR7ZGltZW5zaW9uc30sIDFmcilgO1xuICAgIFxuICAgICAgICBsZXQgbnVtRGl2cyA9IGRpbWVuc2lvbnMgKiBkaW1lbnNpb25zO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bURpdnM7IGkrKyl7XG4gICAgICAgICAgICBsZXQgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyBcbiAgICAgICAgICAgIGNlbGwuY2xhc3NOYW1lID0gJ2NlbGwnXG4gICAgICAgICAgICBjb25zdCB4ID0gaSAlIGRpbWVuc2lvbnM7IC8vIENhbGN1bGF0ZSB4IGNvb3JkaW5hdGVcbiAgICAgICAgICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKGkgLyBkaW1lbnNpb25zKTsgLy8gQ2FsY3VsYXRlIHkgY29vcmRpbmF0ZVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY29vcmRpbmF0ZScsIGBbJHt4fSwgJHt5fV1gKVxuICAgICAgICAgICAgYm9hcmQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYmVmb3JlZW5kXCIsIGNlbGwpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXRyaWV2ZUNvb3JkaW5hdGVzID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGNsaWNrZWRDZWxsID0gZXZlbnQudGFyZ2V0XG4gICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gY2xpY2tlZENlbGwuZ2V0QXR0cmlidXRlKCdkYXRhLWNvb3JkaW5hdGUnKVxuICAgICAgICBjb25zdCBbeCwgeV0gPSBKU09OLnBhcnNlKGNvb3JkaW5hdGVzKVxuICAgICAgICBcbiAgICAgICAgYm9hcmQucGxhY2VTaGlwKFt4LCB5XSxzaGlwTGVuZ3Roc1t0aGlzU2hpcF0pXG4gICAgICAgIFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBMZW5ndGhzW3RoaXNTaGlwXTsgaSsrKXtcbiAgICAgICAgICAgIGxldCBzaGlwQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jZWxsW2RhdGEtY29vcmRpbmF0ZT1cIlske3graX0sICR7eX1dXCJdYClcbiAgICAgICAgICAgIHNoaXBDZWxsLmNsYXNzTmFtZSA9ICdzaGlwLWNlbGwnXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzU2hpcCsrXG4gICAgICAgIGlmICh0aGlzU2hpcCA+PSBzaGlwTGVuZ3Rocy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHByZUJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZS1ib2FyZCcpO1xuICAgICAgICAgICAgcHJlQm9hcmQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXRyaWV2ZUNvb3JkaW5hdGVzKTtcbiAgICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgaW5zZXJ0U2hpcCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcHJlQm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJlLWJvYXJkJylcbiAgICAgICAgcHJlQm9hcmQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAocmV0cmlldmVDb29yZGluYXRlcykpXG4gICAgfVxuXG4gICAgY29uc3QgY2xvc2VNb2RhbCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgYmVnaW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmVnaW4nKVxuICAgICAgICBjb25zdCB3ZWxjb21lU2NyZWVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndlbGNvbWVTY3JlZW4nKVxuICAgICAgICBiZWdpbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHdlbGNvbWVTY3JlZW4uY2xvc2UoKVxuICAgICAgICAgICAgc2hvd1NoaXBzKClcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBjb25zdCBzaG93U2hpcHMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByZUJvYXJkTm9kZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZS1ib2FyZCAuc2hpcC1jZWxsXCIpXG4gICAgICAgIGNvbnN0IGh1bWFuQm9hcmROb2RlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaHVtYW4gLmNlbGxcIilcbiAgICAgICAgY29uc3Qgc2hpcENlbGxzID0gW11cblxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcHJlQm9hcmROb2RlTGlzdC5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBzaGlwQ2VsbHMucHVzaChwcmVCb2FyZE5vZGVMaXN0W2ldLmdldEF0dHJpYnV0ZSgnZGF0YS1jb29yZGluYXRlJykpXG4gICAgICAgIH1cblxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgaHVtYW5Cb2FyZE5vZGVMaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGxldCBub2RlID0gaHVtYW5Cb2FyZE5vZGVMaXN0W2ldXG4gICAgICAgICAgICBsZXQgY29vcmRpbmF0ZSA9IGh1bWFuQm9hcmROb2RlTGlzdFtpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29vcmRpbmF0ZScpXG4gICAgICAgICAgICBpZihzaGlwQ2VsbHMuaW5jbHVkZXMoY29vcmRpbmF0ZSkpe1xuICAgICAgICAgICAgICAgIG5vZGUuY2xhc3NOYW1lID0gJ3NoaXAtY2VsbCdcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgaHVtYW5BdHRhY2sgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgY2xpY2tlZENlbGwgPSBldmVudC50YXJnZXRcbiAgICAgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBjbGlja2VkQ2VsbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29vcmRpbmF0ZScpXG4gICAgICAgIGNvbnN0IFt4LCB5XSA9IEpTT04ucGFyc2UoY29vcmRpbmF0ZXMpXG5cbiAgICAgICAgaHVtYW5QbGF5ZXIuYXR0YWNrKFt4LHldLCBlbmVteUJvYXJkKVxuICAgICAgICBjb25zdCBlbmVteUdyaWQgPSBlbmVteUJvYXJkLmdldEdyaWQoKVxuXG4gICAgICAgIGlmKGVuZW15R3JpZFt4XVt5XSA9PT0gMCl7XG4gICAgICAgICAgICBjbGlja2VkQ2VsbC5jbGFzc05hbWUgPSAnbWlzcydcbiAgICAgICAgfSBlbHNlIHtjbGlja2VkQ2VsbC5jbGFzc05hbWUgPSAnaGl0J31cbiAgICAgICAgYWlBdHRhY2soKSAvL2Vuc3VyZSB0aGF0IGFpIG1ha2VzIGF0dGFjayBhZnRlciBodW1hbiBtYWtlcyBhdHRhY2tcbiAgICB9XG5cbiAgICBjb25zdCBzaG93QXR0YWNrID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBhaUJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbXB1dGVyJylcbiAgICAgICAgYWlCb2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChodW1hbkF0dGFjaykgKVxuICAgIH1cblxuICAgIGNvbnN0IGFpQXR0YWNrID0gKCkgPT4ge1xuICAgICAgICBsZXQgY29vcmRpbmF0ZXMgPSBjb21wdXRlclBsYXllci5jb21wdXRlclBsYXllckF0dGFjayhib2FyZClcbiAgICAgICAgY29uc3QgW3gseV0gPSBjb29yZGluYXRlc1xuICAgICAgICBjb25zdCBteUdyaWQgPSBib2FyZC5nZXRHcmlkKClcbiAgICAgICAgbGV0IGNlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuaHVtYW4gLmNlbGxbZGF0YS1jb29yZGluYXRlPVwiWyR7eH0sICR7eX1dXCJdYClcblxuICAgICAgICBpZiAoIWNlbGwpIHtcbiAgICAgICAgICAgIGNlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuaHVtYW4gLnNoaXAtY2VsbFtkYXRhLWNvb3JkaW5hdGU9XCJbJHt4fSwgJHt5fV1cIl1gKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYobXlHcmlkW3hdW3ldID09PSAwKXtcbiAgICAgICAgICAgIGNlbGwuY2xhc3NOYW1lID0gJ21pc3MnXG4gICAgICAgIH0gZWxzZSB7Y2VsbC5jbGFzc05hbWUgPSAnaGl0J31cbiAgICB9XG5cbnJldHVybiB7Y3JlYXRlQ2VsbHMsIGluc2VydFNoaXAsIGNsb3NlTW9kYWwsIHNob3dTaGlwcywgYWlBdHRhY2ssIHNob3dBdHRhY2t9XG59KTtcblxuXG5leHBvcnQgZGVmYXVsdCBldmVudHMiLCJjb25zdCBwbGF5ZXJGYWN0b3J5ID0gKHBsYXllclR5cGUpID0+IHtcbiAgICBsZXQgaXNNeVR1cm4gPSBudWxsXG4gICAgbGV0IG15QXR0YWNrcyA9IFtdXG5cbiAgICBjb25zdCBodW1hblBsYXllckF0dGFjayA9IChjb29yZGluYXRlcywgYm9hcmQpID0+IHtcbiAgICAgICAgaWYgKGJvYXJkLmlzVmFsaWRBdHRhY2soY29vcmRpbmF0ZXMpKXtcbiAgICAgICAgICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZXMpXG4gICAgICAgIH1cbiAgICAgICAgbXlBdHRhY2tzLnB1c2goY29vcmRpbmF0ZXMpXG4gICAgICAgIGlzTXlUdXJuID0gZmFsc2VcbiAgICB9XG5cbiAgICBjb25zdCBnZXRSYW5kb21Db29yZGluYXRlcyA9ICgpID0+IHtcbiAgICAgICAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMClcbiAgICAgICAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMClcbiAgICAgICAgcmV0dXJuIFt4LCB5XVxuICAgIH1cblxuICAgIGNvbnN0IGNvbXB1dGVyUGxheWVyQXR0YWNrID0gKGJvYXJkKSA9PiB7XG4gICAgICAgIGxldCBjb29yZGluYXRlcyA9IGdldFJhbmRvbUNvb3JkaW5hdGVzKClcbiAgICAgICAgd2hpbGUoIWJvYXJkLmlzVmFsaWRBdHRhY2soY29vcmRpbmF0ZXMpKXtcbiAgICAgICAgICAgIGNvb3JkaW5hdGVzID0gZ2V0UmFuZG9tQ29vcmRpbmF0ZXMoKVxuICAgICAgICB9XG4gICAgICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZXMpXG4gICAgICAgIG15QXR0YWNrcy5wdXNoKGNvb3JkaW5hdGVzKVxuICAgICAgICBpc015VHVybiA9IGZhbHNlXG4gICAgICAgIHJldHVybiBjb29yZGluYXRlc1xuICAgIH1cblxuICAgIGNvbnN0IGF0dGFjayA9IHBsYXllclR5cGUgPT09IFwiaHVtYW5cIiA/IGh1bWFuUGxheWVyQXR0YWNrIDogY29tcHV0ZXJQbGF5ZXJBdHRhY2s7XG5cbiAgICByZXR1cm57aHVtYW5QbGF5ZXJBdHRhY2ssIGNvbXB1dGVyUGxheWVyQXR0YWNrLCBhdHRhY2ssIGlzTXlUdXJuLFxuICAgICAgICAgICBteUF0dGFja3N9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBsYXllckZhY3Rvcnlcbi8vbW9kdWxlLmV4cG9ydHMgPSBwbGF5ZXJGYWN0b3J5IiwiaW1wb3J0IHNoaXBGYWN0b3J5IGZyb20gJy4vc2hpcHMnXG5cbmNvbnN0IGdhbWVib2FyZEZhY3RvcnkgPSAoKSA9PiB7XG4gICAgY29uc3QgZ3JpZCA9IFtdXG4gICAgY29uc3Qgc2hpcHMgPSBbXVxuICAgIGNvbnN0IG1pc3NlZEF0dGFja3MgPSBbXVxuICAgIGNvbnN0IHN1Y2Nlc3NmdWxBdHRhY2tzID0gW11cblxuICAgIGNvbnN0IHBvcHVsYXRlR3JpZCA9ICgpID0+IHtcbiAgICAgICAgbGV0IHJvd3MgPSAxMFxuICAgICAgICBsZXQgY29scyA9IDEwXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCByb3dzOyBpKyspe1xuICAgICAgICAgICAgZ3JpZFtpXSA9IFtdO1xuICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IGNvbHM7IGorKyl7XG4gICAgICAgICAgICAgICAgZ3JpZFtpXVtqXSA9IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHBsYWNlU2hpcCA9IChjb29yZGluYXRlcywgc2hpcExlbmd0aCkgPT4ge1xuICAgICAgICBjb25zdCBzaGlwID0gc2hpcEZhY3Rvcnkoc2hpcExlbmd0aClcbiAgICAgICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZXM7XG4gICAgICAgIFxuICAgICAgICBmb3IobGV0IGkgPTA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgaWYoZ3JpZFt4ICsgaV1beV0gIT09IG51bGwpe1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHBsYWNlIHNoaXAgb24gYW4gb2NjdXBpZWQgc3BvdCcpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGdyaWRbeCArIGldW3ldID0gc2hpcDtcbiAgICAgICAgfVxuXG4gICAgICAgIHNoaXBzLnB1c2goc2hpcClcbiAgICB9XG5cbiAgICBjb25zdCBwbGFjZVJhbmRvbVNoaXBzID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXTtcbiAgICAgICAgXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3Rocy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBsZXQgcGxhY2VkID0gZmFsc2VcbiAgICAgICAgICAgIHdoaWxlKCFwbGFjZWQpe1xuICAgICAgICAgICAgICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApXG4gICAgICAgICAgICAgICAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMClcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBwbGFjZVNoaXAoW3gseV0sIHNoaXBMZW5ndGhzW2ldKVxuICAgICAgICAgICAgICAgICAgICBwbGFjZWQgPSB0cnVlXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3Ipe1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaGlwc1xuICAgICAgfTtcblxuICAgIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICAgICAgY29uc3QgW3gseV0gPSBjb29yZGluYXRlc1xuICAgICAgICBpZihncmlkW3hdW3ldID09PSBudWxsKXtcbiAgICAgICAgICAgIG1pc3NlZEF0dGFja3MucHVzaChbeCx5XSlcbiAgICAgICAgICAgIGdyaWRbeF1beV0gPSAwIC8vMCB3aWxsIGluZGljYXRlIGEgZ3JpZCBwb3NpdGlvbiB0aGF0IHdhcyBhdHRhY2tlZCBhbmQgbWlzc2VkXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgc2hpcCA9IGdyaWRbeF1beV1cbiAgICAgICAgICAgIHNoaXAuaGl0KClcbiAgICAgICAgICAgIHN1Y2Nlc3NmdWxBdHRhY2tzLnB1c2goW3gseV0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBnZXRTaGlwcyA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHNoaXBzXG4gICAgfVxuXG4gICAgY29uc3QgZ2V0R3JpZCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIGdyaWRcbiAgICB9XG5cbiAgICBjb25zdCBhbGxTaGlwc1N1bmsgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBzaGlwcy5ldmVyeSgoc2hpcCkgPT4gc2hpcC5pc1N1bmsoKSlcbiAgICB9XG5cbiAgICBjb25zdCBpc1ZhbGlkQXR0YWNrID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgICAgIGxldCBbeCwgeV0gPSBjb29yZGluYXRlcztcbiAgICAgICAgZm9yIChsZXQgW2F0dGFja1gsIGF0dGFja1ldIG9mIHN1Y2Nlc3NmdWxBdHRhY2tzKSB7XG4gICAgICAgICAgICBpZiAoYXR0YWNrWCA9PT0geCAmJiBhdHRhY2tZID09PSB5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgW2F0dGFja1gsIGF0dGFja1ldIG9mIG1pc3NlZEF0dGFja3MpIHtcbiAgICAgICAgICAgIGlmIChhdHRhY2tYID09PSB4ICYmIGF0dGFja1kgPT09IHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwb3B1bGF0ZUdyaWQoKVxuXG4gICAgcmV0dXJue3BsYWNlU2hpcCwgZ3JpZCwgc2hpcHMsIHJlY2VpdmVBdHRhY2ssIHBsYWNlUmFuZG9tU2hpcHMsIFxuICAgICAgICBtaXNzZWRBdHRhY2tzLCBzdWNjZXNzZnVsQXR0YWNrcywgYWxsU2hpcHNTdW5rLCBpc1ZhbGlkQXR0YWNrLCBcbiAgICAgICAgZ2V0U2hpcHMsIGdldEdyaWR9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgZ2FtZWJvYXJkRmFjdG9yeVxuLy9tb2R1bGUuZXhwb3J0cyA9IGdhbWVib2FyZEZhY3RvcnkiLCJjb25zdCBzaGlwRmFjdG9yeSA9IChsZW5ndGgpID0+IHtcbiAgICBsZXQgaGl0cyA9IDAgXG4gICAgbGV0IHN1bmsgPSBmYWxzZVxuICAgIGxldCBzaGlwTGVuZ3RoID0gbGVuZ3RoXG5cbiAgICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgICAgIGhpdHMgKz0gMVxuICAgICAgICByZXR1cm4gaGl0c1xuICAgIH1cblxuICAgIGNvbnN0IGlzU3VuayA9ICgpID0+IHtcbiAgICAgICAgaWYoaGl0cyA9PT0gc2hpcExlbmd0aCl7XG4gICAgICAgICAgICBzdW5rID0gdHJ1ZVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdW5rXG4gICAgfVxuXG4gICAgcmV0dXJuIHtoaXQsIGlzU3VuaywgaGl0cywgc3Vuaywgc2hpcExlbmd0aH1cbn1cbmV4cG9ydCBkZWZhdWx0IHNoaXBGYWN0b3J5XG4vL21vZHVsZS5leHBvcnRzID0gc2hpcEZhY3RvcnkiLCJpbXBvcnQgZXZlbnRzIGZyb20gXCIuL21vZHVsZXMvZG9tXCI7XG5pbXBvcnQgcGxheWVyRmFjdG9yeSBmcm9tIFwiLi9tb2R1bGVzL3BsYXllclwiXG5pbXBvcnQgZ2FtZWJvYXJkRmFjdG9yeSBmcm9tIFwiLi9tb2R1bGVzL2dhbWVib2FyZFwiXG5cbmNvbnN0IGh1bWFuUGxheWVyID0gcGxheWVyRmFjdG9yeSgnaHVtYW4nKSAvL2NyZWF0ZSBwbGF5ZXIgaW5zdGFuY2VzXG5jb25zdCBhaVBsYXllciA9IHBsYXllckZhY3RvcnkoJ2NvbXB1dGVyJylcblxuY29uc3QgaHVtYW5HYW1lYm9hcmQgPSBnYW1lYm9hcmRGYWN0b3J5KCkgLy9jcmVhdGUgYm9hcmQgaW5zdGFuY2VzIFxuY29uc3QgYWlHYW1lYm9hcmQgPSBnYW1lYm9hcmRGYWN0b3J5KClcblxuY29uc3QgZG9tRXZlbnRzID0gZXZlbnRzKGh1bWFuR2FtZWJvYXJkLCBodW1hblBsYXllciwgYWlHYW1lYm9hcmQsIGFpUGxheWVyIClcblxuZG9tRXZlbnRzLmNyZWF0ZUNlbGxzKCcucHJlLWJvYXJkJylcbmRvbUV2ZW50cy5jbG9zZU1vZGFsKClcbmRvbUV2ZW50cy5jcmVhdGVDZWxscygnLmh1bWFuJylcbmRvbUV2ZW50cy5jcmVhdGVDZWxscygnLmNvbXB1dGVyJylcbmFpR2FtZWJvYXJkLnBsYWNlUmFuZG9tU2hpcHMoKVxuZG9tRXZlbnRzLmluc2VydFNoaXAoKVxuZG9tRXZlbnRzLnNob3dBdHRhY2soKVxuXG5cbiJdLCJuYW1lcyI6WyJwbGF5ZXJUeXBlIiwiaXNNeVR1cm4iLCJteUF0dGFja3MiLCJodW1hblBsYXllckF0dGFjayIsImNvb3JkaW5hdGVzIiwiYm9hcmQiLCJpc1ZhbGlkQXR0YWNrIiwicmVjZWl2ZUF0dGFjayIsInB1c2giLCJnZXRSYW5kb21Db29yZGluYXRlcyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNvbXB1dGVyUGxheWVyQXR0YWNrIiwiYXR0YWNrIiwiZ3JpZCIsInNoaXBzIiwibWlzc2VkQXR0YWNrcyIsInN1Y2Nlc3NmdWxBdHRhY2tzIiwicGxhY2VTaGlwIiwic2hpcExlbmd0aCIsInNoaXAiLCJsZW5ndGgiLCJoaXRzIiwic3VuayIsImhpdCIsImlzU3VuayIsIngiLCJ5IiwiaSIsIkVycm9yIiwiaiIsInBvcHVsYXRlR3JpZCIsInBsYWNlUmFuZG9tU2hpcHMiLCJzaGlwTGVuZ3RocyIsInBsYWNlZCIsImVycm9yIiwiYWxsU2hpcHNTdW5rIiwiZXZlcnkiLCJhdHRhY2tYIiwiYXR0YWNrWSIsImdldFNoaXBzIiwiZ2V0R3JpZCIsImh1bWFuUGxheWVyIiwicGxheWVyIiwiYWlQbGF5ZXIiLCJodW1hbkdhbWVib2FyZCIsImdhbWVib2FyZCIsImFpR2FtZWJvYXJkIiwiZG9tRXZlbnRzIiwiZW5lbXlCb2FyZCIsImNvbXB1dGVyUGxheWVyIiwidGhpc1NoaXAiLCJyZXRyaWV2ZUNvb3JkaW5hdGVzIiwiZXZlbnQiLCJ0YXJnZXQiLCJnZXRBdHRyaWJ1dGUiLCJKU09OIiwicGFyc2UiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc05hbWUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2hvd1NoaXBzIiwicHJlQm9hcmROb2RlTGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJodW1hbkJvYXJkTm9kZUxpc3QiLCJzaGlwQ2VsbHMiLCJub2RlIiwiY29vcmRpbmF0ZSIsImluY2x1ZGVzIiwiaHVtYW5BdHRhY2siLCJjbGlja2VkQ2VsbCIsImFpQXR0YWNrIiwibXlHcmlkIiwiY2VsbCIsImNyZWF0ZUNlbGxzIiwiY29udGFpbmVyIiwic3R5bGUiLCJncmlkVGVtcGxhdGVDb2x1bW5zIiwiZ3JpZFRlbXBsYXRlUm93cyIsImRpbWVuc2lvbnMiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiaW5zZXJ0U2hpcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZU1vZGFsIiwiYmVnaW4iLCJ3ZWxjb21lU2NyZWVuIiwiY2xvc2UiLCJzaG93QXR0YWNrIl0sInNvdXJjZVJvb3QiOiIifQ==