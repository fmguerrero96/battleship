(()=>{"use strict";const e=e=>{let t=null,r=[];const o=(e,o)=>{o.isValidAttack(e)&&o.receiveAttack(e),r.push(e),t=!1},c=()=>[Math.floor(10*Math.random()),Math.floor(10*Math.random())],l=e=>{const o=c();for(;!e.isValidAttack(o);)o=c;e.receiveAttack(o),r.push(o),t=!1};return{humanPlayerAttack:o,computerPlayerAttack:l,attack:"human"===e?o:l,isMyTurn:t,myAttacks:r}},t=()=>{const e=[],t=[],r=[],o=[],c=(r,o)=>{const c=(e=>{let t=0,r=!1,o=e;return{hit:()=>(t+=1,t),isSunk:()=>(t===o&&(r=!0),r),hits:t,sunk:r,shipLength:o}})(o),[l,a]=r;for(let t=0;t<o;t++)if(null!==e[l+t][a])throw new Error("Cannot place ship on an occupied spot");for(let t=0;t<o;t++)e[l+t][a]=c;t.push(c)};return(()=>{for(let t=0;t<10;t++){e[t]=[];for(let r=0;r<10;r++)e[t][r]=null}})(),{placeShip:c,grid:e,ships:t,receiveAttack:t=>{const[c,l]=t;null===e[c][l]?(r.push([c,l]),e[c][l]=0):(e[c][l].hit(),o.push([c,l]))},placeRandomShips:()=>{const e=[5,4,3,3,2];for(let t=0;t<e.length;t++){let r=!1;for(;!r;){let o=Math.floor(10*Math.random()),l=Math.floor(10*Math.random());try{c([o,l],e[t]),r=!0}catch(e){}}}return t},missedAttacks:r,successfulAttacks:o,allShipsSunk:()=>t.every((e=>e.isSunk())),isValidAttack:e=>{const[t,c]=e;for(const[e,r]of o)if(e===t&&r===c)return!1;for(const[e,o]of r)if(e===t&&o===c)return!1;return!0},getShips:()=>t,getGrid:()=>e}},r=e("human"),o=(e("computer"),t()),c=t(),l=((e,t,r,o)=>{const c=[5,4,3,3,2];let l=0;const a=t=>{const r=t.target.getAttribute("data-coordinate"),[o,s]=JSON.parse(r);e.placeShip([o,s],c[l]);for(let e=0;e<c[l];e++)document.querySelector(`.cell[data-coordinate="[${o+e}, ${s}]"]`).className="ship-cell";l++,l>=c.length&&document.querySelector(".pre-board").removeEventListener("click",a)},s=()=>{const e=document.querySelectorAll(".pre-board .ship-cell"),t=document.querySelectorAll(".human .cell"),r=[];for(let t=0;t<e.length;t++)r.push(e[t].getAttribute("data-coordinate"));for(let e=0;e<t.length;e++){let o=t[e],c=t[e].getAttribute("data-coordinate");r.includes(c)&&(o.className="ship-cell")}},n=e=>{const o=e.target,c=o.getAttribute("data-coordinate"),[l,a]=JSON.parse(c);r.attack([l,a],t);const s=t.getGrid();console.log(s),0===s[l][a]?o.className="miss":o.className="hit"};return{createCells:e=>{const t=document.querySelector(e);t.style.gridTemplateColumns="repeat(10, 1fr)",t.style.gridTemplateRows="repeat(10, 1fr)";for(let e=0;e<100;e++){let r=document.createElement("div");r.className="cell";const o=e%10,c=Math.floor(e/10);r.setAttribute("data-coordinate",`[${o}, ${c}]`),t.insertAdjacentElement("beforeend",r)}},insertShip:()=>{document.querySelector(".pre-board").addEventListener("click",a)},closeModal:()=>{const e=document.querySelector(".begin"),t=document.querySelector(".welcomeScreen");e.addEventListener("click",(()=>{t.close(),s()}))},showShips:s,showAttack:()=>{document.querySelector(".computer").addEventListener("click",n)}}})(o,c,r);l.createCells(".pre-board"),l.createCells(".human"),l.createCells(".computer"),c.placeRandomShips(),l.insertShip(),l.closeModal(),l.showAttack()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YUosR0FFdERLLEVBQVUyQixZQUFZLGNBQ3RCM0IsRUFBVTJCLFlBQVksVUFDdEIzQixFQUFVMkIsWUFBWSxhQUV0QjVCLEVBQVlkLG1CQUNaZSxFQUFVcUMsYUFDVnJDLEVBQVV1QyxhQUNWdkMsRUFBVTJDLFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvZG9tLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvc2hpcHMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc2hpcEZhY3RvcnkgZnJvbSBcIi4vc2hpcHNcIjtcblxuY29uc3QgZXZlbnRzID0gKChib2FyZCwgZW5lbXlCb2FyZCwgaHVtYW5QbGF5ZXIsIGNvbXB1dGVyUGxheWVyKSA9PiB7XG4gICAgY29uc3Qgc2hpcExlbmd0aHMgPSBbNSwgNCwgMywgMywgMl07XG4gICAgbGV0IHRoaXNTaGlwID0gMFxuXG4gICAgY29uc3QgY3JlYXRlQ2VsbHMgPSAoY29udGFpbmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IGRpbWVuc2lvbnMgPSAxMFxuICAgICAgICBjb25zdCBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKVxuICAgICAgICBib2FyZC5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdCgke2RpbWVuc2lvbnN9LCAxZnIpYDtcbiAgICAgICAgYm9hcmQuc3R5bGUuZ3JpZFRlbXBsYXRlUm93cyA9IGByZXBlYXQoJHtkaW1lbnNpb25zfSwgMWZyKWA7XG4gICAgXG4gICAgICAgIGxldCBudW1EaXZzID0gZGltZW5zaW9ucyAqIGRpbWVuc2lvbnM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtRGl2czsgaSsrKXtcbiAgICAgICAgICAgIGxldCBjZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IFxuICAgICAgICAgICAgY2VsbC5jbGFzc05hbWUgPSAnY2VsbCdcbiAgICAgICAgICAgIGNvbnN0IHggPSBpICUgZGltZW5zaW9uczsgLy8gQ2FsY3VsYXRlIHggY29vcmRpbmF0ZVxuICAgICAgICAgICAgY29uc3QgeSA9IE1hdGguZmxvb3IoaSAvIGRpbWVuc2lvbnMpOyAvLyBDYWxjdWxhdGUgeSBjb29yZGluYXRlXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnZGF0YS1jb29yZGluYXRlJywgYFske3h9LCAke3l9XWApXG4gICAgICAgICAgICBib2FyZC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJiZWZvcmVlbmRcIiwgY2VsbClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHJldHJpZXZlQ29vcmRpbmF0ZXMgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgY2xpY2tlZENlbGwgPSBldmVudC50YXJnZXRcbiAgICAgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBjbGlja2VkQ2VsbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29vcmRpbmF0ZScpXG4gICAgICAgIGNvbnN0IFt4LCB5XSA9IEpTT04ucGFyc2UoY29vcmRpbmF0ZXMpXG4gICAgICAgIFxuICAgICAgICBib2FyZC5wbGFjZVNoaXAoW3gsIHldLHNoaXBMZW5ndGhzW3RoaXNTaGlwXSlcbiAgICAgICAgXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aHNbdGhpc1NoaXBdOyBpKyspe1xuICAgICAgICAgICAgbGV0IHNoaXBDZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmNlbGxbZGF0YS1jb29yZGluYXRlPVwiWyR7eCtpfSwgJHt5fV1cIl1gKVxuICAgICAgICAgICAgc2hpcENlbGwuY2xhc3NOYW1lID0gJ3NoaXAtY2VsbCdcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXNTaGlwKytcbiAgICAgICAgaWYgKHRoaXNTaGlwID49IHNoaXBMZW5ndGhzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcHJlQm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJlLWJvYXJkJyk7XG4gICAgICAgICAgICBwcmVCb2FyZC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHJldHJpZXZlQ29vcmRpbmF0ZXMpO1xuICAgICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBpbnNlcnRTaGlwID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBwcmVCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmUtYm9hcmQnKVxuICAgICAgICBwcmVCb2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChyZXRyaWV2ZUNvb3JkaW5hdGVzKSlcbiAgICB9XG5cbiAgICBjb25zdCBjbG9zZU1vZGFsID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBiZWdpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5iZWdpbicpXG4gICAgICAgIGNvbnN0IHdlbGNvbWVTY3JlZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2VsY29tZVNjcmVlbicpXG4gICAgICAgIGJlZ2luLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgd2VsY29tZVNjcmVlbi5jbG9zZSgpXG4gICAgICAgICAgICBzaG93U2hpcHMoKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IHNob3dTaGlwcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcHJlQm9hcmROb2RlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlLWJvYXJkIC5zaGlwLWNlbGxcIilcbiAgICAgICAgY29uc3QgaHVtYW5Cb2FyZE5vZGVMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5odW1hbiAuY2VsbFwiKVxuICAgICAgICBjb25zdCBzaGlwQ2VsbHMgPSBbXVxuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBwcmVCb2FyZE5vZGVMaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHNoaXBDZWxscy5wdXNoKHByZUJvYXJkTm9kZUxpc3RbaV0uZ2V0QXR0cmlidXRlKCdkYXRhLWNvb3JkaW5hdGUnKSlcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBodW1hbkJvYXJkTm9kZUxpc3QubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgbGV0IG5vZGUgPSBodW1hbkJvYXJkTm9kZUxpc3RbaV1cbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlID0gaHVtYW5Cb2FyZE5vZGVMaXN0W2ldLmdldEF0dHJpYnV0ZSgnZGF0YS1jb29yZGluYXRlJylcbiAgICAgICAgICAgIGlmKHNoaXBDZWxscy5pbmNsdWRlcyhjb29yZGluYXRlKSl7XG4gICAgICAgICAgICAgICAgbm9kZS5jbGFzc05hbWUgPSAnc2hpcC1jZWxsJ1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBodW1hbkF0dGFjayA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCBjbGlja2VkQ2VsbCA9IGV2ZW50LnRhcmdldFxuICAgICAgICBjb25zdCBjb29yZGluYXRlcyA9IGNsaWNrZWRDZWxsLmdldEF0dHJpYnV0ZSgnZGF0YS1jb29yZGluYXRlJylcbiAgICAgICAgY29uc3QgW3gsIHldID0gSlNPTi5wYXJzZShjb29yZGluYXRlcylcblxuICAgICAgICBodW1hblBsYXllci5hdHRhY2soW3gseV0sIGVuZW15Qm9hcmQpXG4gICAgICAgIGNvbnN0IGVuZW15R3JpZCA9IGVuZW15Qm9hcmQuZ2V0R3JpZCgpXG4gICAgICAgIGNvbnNvbGUubG9nKGVuZW15R3JpZClcblxuXG4gICAgICAgIGlmKGVuZW15R3JpZFt4XVt5XSA9PT0gMCl7XG4gICAgICAgICAgICBjbGlja2VkQ2VsbC5jbGFzc05hbWUgPSAnbWlzcydcbiAgICAgICAgfSBlbHNlIHtjbGlja2VkQ2VsbC5jbGFzc05hbWUgPSAnaGl0J31cbiAgICB9XG5cbiAgICBjb25zdCBzaG93QXR0YWNrID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBhaUJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbXB1dGVyJylcbiAgICAgICAgYWlCb2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChodW1hbkF0dGFjaykgKVxuICAgIH1cblxucmV0dXJuIHtjcmVhdGVDZWxscywgaW5zZXJ0U2hpcCwgY2xvc2VNb2RhbCwgc2hvd1NoaXBzLCBzaG93QXR0YWNrfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGV2ZW50cyIsImNvbnN0IHBsYXllckZhY3RvcnkgPSAocGxheWVyVHlwZSkgPT4ge1xuICAgIGxldCBpc015VHVybiA9IG51bGxcbiAgICBsZXQgbXlBdHRhY2tzID0gW11cblxuICAgIGNvbnN0IGh1bWFuUGxheWVyQXR0YWNrID0gKGNvb3JkaW5hdGVzLCBib2FyZCkgPT4ge1xuICAgICAgICBpZiAoYm9hcmQuaXNWYWxpZEF0dGFjayhjb29yZGluYXRlcykpe1xuICAgICAgICAgICAgYm9hcmQucmVjZWl2ZUF0dGFjayhjb29yZGluYXRlcylcbiAgICAgICAgfVxuICAgICAgICBteUF0dGFja3MucHVzaChjb29yZGluYXRlcylcbiAgICAgICAgaXNNeVR1cm4gPSBmYWxzZVxuICAgIH1cblxuICAgIGNvbnN0IGdldFJhbmRvbUNvb3JkaW5hdGVzID0gKCkgPT4ge1xuICAgICAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKVxuICAgICAgICBsZXQgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKVxuICAgICAgICByZXR1cm4gW3gsIHldXG4gICAgfVxuXG4gICAgY29uc3QgY29tcHV0ZXJQbGF5ZXJBdHRhY2sgPSAoYm9hcmQpID0+IHtcbiAgICAgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBnZXRSYW5kb21Db29yZGluYXRlcygpXG4gICAgICAgIHdoaWxlKCFib2FyZC5pc1ZhbGlkQXR0YWNrKGNvb3JkaW5hdGVzKSl7XG4gICAgICAgICAgICBjb29yZGluYXRlcyA9IGdldFJhbmRvbUNvb3JkaW5hdGVzXG4gICAgICAgIH1cbiAgICAgICAgYm9hcmQucmVjZWl2ZUF0dGFjayhjb29yZGluYXRlcylcbiAgICAgICAgbXlBdHRhY2tzLnB1c2goY29vcmRpbmF0ZXMpXG4gICAgICAgIGlzTXlUdXJuID0gZmFsc2VcbiAgICB9XG5cbiAgICBjb25zdCBhdHRhY2sgPSBwbGF5ZXJUeXBlID09PSBcImh1bWFuXCIgPyBodW1hblBsYXllckF0dGFjayA6IGNvbXB1dGVyUGxheWVyQXR0YWNrO1xuXG4gICAgcmV0dXJue2h1bWFuUGxheWVyQXR0YWNrLCBjb21wdXRlclBsYXllckF0dGFjaywgYXR0YWNrLCBpc015VHVybixcbiAgICAgICAgICAgbXlBdHRhY2tzfVxufVxuXG5leHBvcnQgZGVmYXVsdCBwbGF5ZXJGYWN0b3J5XG4vL21vZHVsZS5leHBvcnRzID0gcGxheWVyRmFjdG9yeSIsImltcG9ydCBzaGlwRmFjdG9yeSBmcm9tICcuL3NoaXBzJ1xuXG5jb25zdCBnYW1lYm9hcmRGYWN0b3J5ID0gKCkgPT4ge1xuICAgIGNvbnN0IGdyaWQgPSBbXVxuICAgIGNvbnN0IHNoaXBzID0gW11cbiAgICBjb25zdCBtaXNzZWRBdHRhY2tzID0gW11cbiAgICBjb25zdCBzdWNjZXNzZnVsQXR0YWNrcyA9IFtdXG5cbiAgICBjb25zdCBwb3B1bGF0ZUdyaWQgPSAoKSA9PiB7XG4gICAgICAgIGxldCByb3dzID0gMTBcbiAgICAgICAgbGV0IGNvbHMgPSAxMFxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcm93czsgaSsrKXtcbiAgICAgICAgICAgIGdyaWRbaV0gPSBbXTtcbiAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCBjb2xzOyBqKyspe1xuICAgICAgICAgICAgICAgIGdyaWRbaV1bal0gPSBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBwbGFjZVNoaXAgPSAoY29vcmRpbmF0ZXMsIHNoaXBMZW5ndGgpID0+IHtcbiAgICAgICAgY29uc3Qgc2hpcCA9IHNoaXBGYWN0b3J5KHNoaXBMZW5ndGgpXG4gICAgICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuICAgICAgICBcbiAgICAgICAgZm9yKGxldCBpID0wOyBpIDwgc2hpcExlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGlmKGdyaWRbeCArIGldW3ldICE9PSBudWxsKXtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBwbGFjZSBzaGlwIG9uIGFuIG9jY3VwaWVkIHNwb3QnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHNoaXBMZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBncmlkW3ggKyBpXVt5XSA9IHNoaXA7XG4gICAgICAgIH1cblxuICAgICAgICBzaGlwcy5wdXNoKHNoaXApXG4gICAgfVxuXG4gICAgY29uc3QgcGxhY2VSYW5kb21TaGlwcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2hpcExlbmd0aHMgPSBbNSwgNCwgMywgMywgMl07XG4gICAgICAgIFxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aHMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgbGV0IHBsYWNlZCA9IGZhbHNlXG4gICAgICAgICAgICB3aGlsZSghcGxhY2VkKXtcbiAgICAgICAgICAgICAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKVxuICAgICAgICAgICAgICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VTaGlwKFt4LHldLCBzaGlwTGVuZ3Roc1tpXSlcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VkID0gdHJ1ZVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKXtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hpcHNcbiAgICAgIH07XG5cbiAgICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgICAgIGNvbnN0IFt4LHldID0gY29vcmRpbmF0ZXNcbiAgICAgICAgaWYoZ3JpZFt4XVt5XSA9PT0gbnVsbCl7XG4gICAgICAgICAgICBtaXNzZWRBdHRhY2tzLnB1c2goW3gseV0pXG4gICAgICAgICAgICBncmlkW3hdW3ldID0gMCAvLzAgd2lsbCBpbmRpY2F0ZSBhIGdyaWQgcG9zaXRpb24gdGhhdCB3YXMgYXR0YWNrZWQgYW5kIG1pc3NlZFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHNoaXAgPSBncmlkW3hdW3ldXG4gICAgICAgICAgICBzaGlwLmhpdCgpXG4gICAgICAgICAgICBzdWNjZXNzZnVsQXR0YWNrcy5wdXNoKFt4LHldKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZ2V0U2hpcHMgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBzaGlwc1xuICAgIH1cblxuICAgIGNvbnN0IGdldEdyaWQgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBncmlkXG4gICAgfVxuXG4gICAgY29uc3QgYWxsU2hpcHNTdW5rID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gc2hpcHMuZXZlcnkoKHNoaXApID0+IHNoaXAuaXNTdW5rKCkpXG4gICAgfVxuXG4gICAgY29uc3QgaXNWYWxpZEF0dGFjayA9IChjb29yZGluYXRlcykgPT4ge1xuICAgICAgICBjb25zdCBbeCwgeV0gPSBjb29yZGluYXRlcztcbiAgICAgICAgZm9yIChjb25zdCBbYXR0YWNrWCwgYXR0YWNrWV0gb2Ygc3VjY2Vzc2Z1bEF0dGFja3MpIHtcbiAgICAgICAgICAgIGlmIChhdHRhY2tYID09PSB4ICYmIGF0dGFja1kgPT09IHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBbYXR0YWNrWCwgYXR0YWNrWV0gb2YgbWlzc2VkQXR0YWNrcykge1xuICAgICAgICAgICAgaWYgKGF0dGFja1ggPT09IHggJiYgYXR0YWNrWSA9PT0geSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHBvcHVsYXRlR3JpZCgpXG5cbiAgICByZXR1cm57cGxhY2VTaGlwLCBncmlkLCBzaGlwcywgcmVjZWl2ZUF0dGFjaywgcGxhY2VSYW5kb21TaGlwcywgXG4gICAgICAgIG1pc3NlZEF0dGFja3MsIHN1Y2Nlc3NmdWxBdHRhY2tzLCBhbGxTaGlwc1N1bmssIGlzVmFsaWRBdHRhY2ssIFxuICAgICAgICBnZXRTaGlwcywgZ2V0R3JpZH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBnYW1lYm9hcmRGYWN0b3J5XG4vL21vZHVsZS5leHBvcnRzID0gZ2FtZWJvYXJkRmFjdG9yeSIsImNvbnN0IHNoaXBGYWN0b3J5ID0gKGxlbmd0aCkgPT4ge1xuICAgIGxldCBoaXRzID0gMCBcbiAgICBsZXQgc3VuayA9IGZhbHNlXG4gICAgbGV0IHNoaXBMZW5ndGggPSBsZW5ndGhcblxuICAgIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICAgICAgaGl0cyArPSAxXG4gICAgICAgIHJldHVybiBoaXRzXG4gICAgfVxuXG4gICAgY29uc3QgaXNTdW5rID0gKCkgPT4ge1xuICAgICAgICBpZihoaXRzID09PSBzaGlwTGVuZ3RoKXtcbiAgICAgICAgICAgIHN1bmsgPSB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1bmtcbiAgICB9XG5cbiAgICByZXR1cm4ge2hpdCwgaXNTdW5rLCBoaXRzLCBzdW5rLCBzaGlwTGVuZ3RofVxufVxuZXhwb3J0IGRlZmF1bHQgc2hpcEZhY3Rvcnlcbi8vbW9kdWxlLmV4cG9ydHMgPSBzaGlwRmFjdG9yeSIsImltcG9ydCBldmVudHMgZnJvbSBcIi4vbW9kdWxlcy9kb21cIjtcbmltcG9ydCBwbGF5ZXJGYWN0b3J5IGZyb20gXCIuL21vZHVsZXMvcGxheWVyXCJcbmltcG9ydCBnYW1lYm9hcmRGYWN0b3J5IGZyb20gXCIuL21vZHVsZXMvZ2FtZWJvYXJkXCJcblxuY29uc3QgaHVtYW5QbGF5ZXIgPSBwbGF5ZXJGYWN0b3J5KCdodW1hbicpIC8vY3JlYXRlIHBsYXllciBpbnN0YW5jZXNcbmNvbnN0IGFpUGxheWVyID0gcGxheWVyRmFjdG9yeSgnY29tcHV0ZXInKVxuXG5jb25zdCBodW1hbkdhbWVib2FyZCA9IGdhbWVib2FyZEZhY3RvcnkoKSAvL2NyZWF0ZSBib2FyZCBpbnN0YW5jZXMgXG5jb25zdCBhaUdhbWVib2FyZCA9IGdhbWVib2FyZEZhY3RvcnkoKVxuXG5jb25zdCBkb21FdmVudHMgPSBldmVudHMoaHVtYW5HYW1lYm9hcmQsIGFpR2FtZWJvYXJkLCBodW1hblBsYXllciwgYWlQbGF5ZXIpXG5cbmRvbUV2ZW50cy5jcmVhdGVDZWxscygnLnByZS1ib2FyZCcpXG5kb21FdmVudHMuY3JlYXRlQ2VsbHMoJy5odW1hbicpXG5kb21FdmVudHMuY3JlYXRlQ2VsbHMoJy5jb21wdXRlcicpXG5cbmFpR2FtZWJvYXJkLnBsYWNlUmFuZG9tU2hpcHMoKSAvL3BvcHVsYXRlIGFpIGJvYXJkIHdpdGggc2hpcHNcbmRvbUV2ZW50cy5pbnNlcnRTaGlwKClcbmRvbUV2ZW50cy5jbG9zZU1vZGFsKClcbmRvbUV2ZW50cy5zaG93QXR0YWNrKClcbiJdLCJuYW1lcyI6WyJwbGF5ZXJUeXBlIiwiaXNNeVR1cm4iLCJteUF0dGFja3MiLCJodW1hblBsYXllckF0dGFjayIsImNvb3JkaW5hdGVzIiwiYm9hcmQiLCJpc1ZhbGlkQXR0YWNrIiwicmVjZWl2ZUF0dGFjayIsInB1c2giLCJnZXRSYW5kb21Db29yZGluYXRlcyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNvbXB1dGVyUGxheWVyQXR0YWNrIiwiYXR0YWNrIiwiZ3JpZCIsInNoaXBzIiwibWlzc2VkQXR0YWNrcyIsInN1Y2Nlc3NmdWxBdHRhY2tzIiwicGxhY2VTaGlwIiwic2hpcExlbmd0aCIsInNoaXAiLCJsZW5ndGgiLCJoaXRzIiwic3VuayIsImhpdCIsImlzU3VuayIsIngiLCJ5IiwiaSIsIkVycm9yIiwiaiIsInBvcHVsYXRlR3JpZCIsInBsYWNlUmFuZG9tU2hpcHMiLCJzaGlwTGVuZ3RocyIsInBsYWNlZCIsImVycm9yIiwiYWxsU2hpcHNTdW5rIiwiZXZlcnkiLCJhdHRhY2tYIiwiYXR0YWNrWSIsImdldFNoaXBzIiwiZ2V0R3JpZCIsImh1bWFuUGxheWVyIiwicGxheWVyIiwiaHVtYW5HYW1lYm9hcmQiLCJnYW1lYm9hcmQiLCJhaUdhbWVib2FyZCIsImRvbUV2ZW50cyIsImVuZW15Qm9hcmQiLCJjb21wdXRlclBsYXllciIsInRoaXNTaGlwIiwicmV0cmlldmVDb29yZGluYXRlcyIsImV2ZW50IiwidGFyZ2V0IiwiZ2V0QXR0cmlidXRlIiwiSlNPTiIsInBhcnNlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NOYW1lIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNob3dTaGlwcyIsInByZUJvYXJkTm9kZUxpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaHVtYW5Cb2FyZE5vZGVMaXN0Iiwic2hpcENlbGxzIiwibm9kZSIsImNvb3JkaW5hdGUiLCJpbmNsdWRlcyIsImh1bWFuQXR0YWNrIiwiY2xpY2tlZENlbGwiLCJlbmVteUdyaWQiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlQ2VsbHMiLCJjb250YWluZXIiLCJzdHlsZSIsImdyaWRUZW1wbGF0ZUNvbHVtbnMiLCJncmlkVGVtcGxhdGVSb3dzIiwiZGltZW5zaW9ucyIsImNlbGwiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiaW5zZXJ0U2hpcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZU1vZGFsIiwiYmVnaW4iLCJ3ZWxjb21lU2NyZWVuIiwiY2xvc2UiLCJzaG93QXR0YWNrIl0sInNvdXJjZVJvb3QiOiIifQ==